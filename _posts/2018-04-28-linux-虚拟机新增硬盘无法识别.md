---
layout: post
category: "linux"
title:  "虚拟机Vcenter添加硬盘无法识别"
tags: [linux, 硬盘]
---
### 虚拟机Vcenter添加硬盘无法识别
最近在项目上遇到的一个问题，在Vcenter中为虚拟机添加一块硬盘用于扩展逻辑卷，但是添加之后发现使用
fdisk -l信息不变，新增的硬盘并没有识别，这种情况下重启虚拟机硬盘就会识别出来，但是环境要求不能重启，
经过查找发现有如下方法：

先查看/proc/scsi/scsi文件
![scsi文件]({{"/assets/linux/1.jpg" | absolute_url}})

使用命令 echo "scsi add-single-device 2 0 2 0">/proc/scis/scsi
\# echo "scsi add-single-device w x y z" > /proc/scsi/scsi
参数值 w、x、y 、 z，解释如下：
w（Host）是主机适配器标识，第一个适配器为零（0）
x （Channel）是主机适配器上的 SCSI 通道，第一个通道为零（0）
y （ID）是设备的 SCSI 标识
z （Lun）是 LUN 号，第一个 LUN 为零（0）

![图片]({{"/assets/linux/2.jpg" | absolute_url}})

再次使用fdisk -l查看发现新增的磁盘已经能显示相关信息了

scsi文件中会有两条记录，在添加时选择Type:   Direct-Access的Host类型添加